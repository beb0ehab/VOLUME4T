<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>باقات السوق السعودي - Volume4T</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        .glass-card {
            background: rgba(25, 28, 36, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        .golden-glow {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1), 0 0 35px 0px rgba(251, 191, 36, 0.5);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <!-- Header -->
    <header class="bg-black/30 backdrop-blur-xl sticky top-0 z-50 border-b border-gray-700/50">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold text-white">Volume4T<span class="text-teal-400">.</span></a>
            <a href="index.html" class="flex items-center text-gray-300 hover:text-white transition-colors bg-white/5 hover:bg-white/10 px-4 py-2 rounded-full">
                <span>العودة للرئيسية</span>
                <i class="fas fa-arrow-left mr-2"></i>
            </a>
        </div>
    </header>

    <main>
        <!-- Page Title Section -->
        <section class="py-20 text-center">
            <div class="container mx-auto px-6">
                <div class="text-teal-400 text-5xl mb-4">
                    <i class="fas fa-box-open"></i>
                </div>
                <h1 class="text-4xl md:text-5xl font-extrabold text-white">باقات السوق السعودي</h1>
                <p class="mt-4 text-lg text-gray-400 max-w-2xl mx-auto">
                    اختر الباقة التي تناسب أهدافك الاستثمارية وابدأ رحلتك نحو الاحتراف.
                </p>
            </div>
        </section>

        <!-- Secure Content Wrapper -->
        <section class="py-20">
            <!-- This part is shown to LOGGED IN users -->
            <div id="packages-section" class="hidden container mx-auto px-6">
                <div id="packages-container">
                    <!-- Packages will be loaded here by JavaScript -->
                    <p class="text-center text-xl text-gray-400">جاري تحميل الباقات...</p>
                </div>
            </div>

            <!-- This part is shown to LOGGED OUT users -->
            <div id="login-prompt-section" class="hidden container mx-auto px-6 text-center">
                <div class="max-w-2xl mx-auto glass-card p-12 rounded-2xl">
                    <i class="fas fa-lock text-5xl text-amber-400 mb-6"></i>
                    <h2 class="text-3xl font-bold text-white mb-4">هذا المحتوى حصري للأعضاء</h2>
                    <p class="text-gray-300 mb-8">يرجى تسجيل الدخول أو إنشاء حساب جديد لتتمكن من عرض الباقات والاشتراك بها.</p>
                    <div class="flex justify-center items-center gap-4 flex-wrap">
                        <a href="login.html" class="bg-blue-600 text-white font-bold py-3 px-10 rounded-full text-lg hover:bg-blue-700 transition-colors">
                            تسجيل الدخول
                        </a>
                         <a href="signup.html" class="bg-white/10 border border-white/20 text-white font-bold py-3 px-10 rounded-full text-lg hover:bg-white/20 transition-colors">
                            إنشاء حساب جديد
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-black/30 backdrop-blur-xl border-t border-gray-700/50">
        <div class="container mx-auto px-6 py-8 text-center text-gray-400">
            <p>&copy; 2024 جميع الحقوق محفوظة | Volume4T.</p>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBkajwsO5ME11NravlECLJSlk4GN0xGbGE",
            authDomain: "sco4mfortelegram.firebaseapp.com",
            projectId: "sco4mfortelegram",
            storageBucket: "sco4mfortelegram.appspot.com",
            messagingSenderId: "72437321483",
            appId: "1:72437321483:web:e89c4ff409f9c477605c0e",
            measurementId: "G-0BZWRPSB76"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        const packagesSection = document.getElementById('packages-section');
        const loginPromptSection = document.getElementById('login-prompt-section');
        const packagesContainer = document.getElementById('packages-container');
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is logged in, show packages
                packagesSection.classList.remove('hidden');
                loginPromptSection.classList.add('hidden');
                fetchPackages();
            } else {
                // User is logged out, show login prompt
                packagesSection.classList.add('hidden');
                loginPromptSection.classList.remove('hidden');
            }
        });

        const packageTypes = { modaraba: 'المضاربة', swing: 'Swing', investment: 'الاستثمار' };
        const tiers = { basic: 'Basic', plus: 'Plus', pro: 'Pro' };
        const tierStyles = {
            basic: { borderColor: 'border-gray-500', headerColor: 'text-gray-300', iconColor: 'text-gray-400', buttonClass: 'bg-white/10 border border-white/20 hover:bg-white/20', shadowClass: '' },
            plus: { borderColor: 'border-amber-400', headerColor: 'text-amber-400', iconColor: 'text-amber-400', buttonClass: 'bg-amber-500 hover:bg-amber-600', badge: 'الأكثر شيوعاً', shadowClass: 'golden-glow' },
            pro: { borderColor: 'border-teal-400', headerColor: 'text-teal-400', iconColor: 'text-teal-400', buttonClass: 'bg-teal-500 hover:bg-teal-600', shadowClass: '' }
        };

        async function fetchPackages() {
            try {
                const marketId = 'saudi';
                const docRef = doc(db, "markets", marketId);
                const docSnap = await getDoc(docRef);

                packagesContainer.innerHTML = '';

                if (!docSnap.exists()) {
                    packagesContainer.innerHTML = '<p class="text-center text-xl text-gray-400">لا توجد باقات متاحة حالياً.</p>';
                    return;
                }

                const marketData = docSnap.data();
                let html = '';

                for (const typeKey in packageTypes) {
                    if (marketData[typeKey]) {
                        html += `<div class="mb-16"><h2 class="text-3xl font-bold text-center text-white mb-12">${packageTypes[typeKey]}</h2><div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 items-stretch">`;
                        for (const tierKey in tiers) {
                            const packageData = marketData[typeKey][tierKey];
                            const style = tierStyles[tierKey];
                            if (packageData) {
                                html += `<div class="glass-card pt-8 p-8 flex flex-col transform hover:scale-105 transition-transform duration-300 ${style.shadowClass || ''}">
                                    ${style.badge ? `<div class="absolute top-0 right-1/2 translate-x-1/2 -translate-y-1/2 bg-amber-400 text-gray-900 text-sm font-bold px-4 py-1 rounded-full">${style.badge}</div>` : ''}
                                    <h3 class="text-2xl font-bold text-center ${style.headerColor}">${tiers[tierKey]}</h3>
                                    <p class="text-4xl font-extrabold text-center text-white my-6">${packageData.price || 'N/A'}</p>
                                    <ul class="space-y-4 text-gray-300 mb-8 flex-grow">`;
                                packageData.features.forEach(feature => {
                                    html += `<li class="flex items-start"><i class="fas fa-check-circle ${style.iconColor} mr-3 ml-3 mt-1 flex-shrink-0"></i><span>${feature}</span></li>`;
                                });
                                html += `</ul><a href="#" class="block w-full text-white font-bold py-3 px-6 rounded-full text-lg text-center mt-auto transition-colors ${style.buttonClass}">اشترك الآن</a></div>`;
                            }
                        }
                        html += `</div></div>`;
                    }
                }
                packagesContainer.innerHTML = html;
            } catch (error) {
                console.error("Error fetching packages: ", error);
                packagesContainer.innerHTML = '<p class="text-center text-xl text-red-500">حدث خطأ أثناء تحميل الباقات.</p>';
            }
        }
    </script>
</body>
</html>
